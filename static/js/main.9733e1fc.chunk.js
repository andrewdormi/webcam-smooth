(this["webpackJsonpwebcam-smooth"]=this["webpackJsonpwebcam-smooth"]||[]).push([[0],{12:function(e,t,a){},14:function(e,t,a){},15:function(e,t,a){"use strict";a.r(t);var n,r,o,i,l=a(0),s=a.n(l),c=a(5),u=a.n(c),d=(a(12),a(3)),v=a.n(d),m=a(6),f=a(2),g=a(1);a(14);var h=function(){var e=Object(l.useState)(10),t=Object(f.a)(e,2),a=t[0],c=t[1],u=Object(l.useState)(1),d=Object(f.a)(u,2),h=d[0],x=d[1],p=Object(l.useState)(.05),w=Object(f.a)(p,2),y=w[0],S=w[1],b=Object(l.useRef)(),E=Object(l.useRef)(),P=function e(t){requestAnimationFrame((function(){return e(t)})),function(){var e=b.current,t=e.videoWidth,l=e.videoHeight;if(t&&l){if(!n){(n=new g.b(t/-2,t/2,l/2,l/-2,1,1e3)).position.z=1,r=new g.d;var s=E.current.getContext("webgl2",{alpha:!1});(o=new g.h({alpha:!0,antialias:!0,canvas:E.current,context:s})).setPixelRatio(window.devicePixelRatio),o.setSize(t,l);var c=new g.g(e),u=new g.c(t,l);i={iChannel0:{type:"t",value:c},resolution:{type:"v2",value:new g.f(2*t,2*l)},sigma:{type:"f",value:a},radius:{type:"f",value:h},threshold:{type:"f",value:y}};var d=new g.e({uniforms:i,fragmentShader:document.getElementById("fs").textContent.trim(),transparent:!0,depthTest:!1});d.needsUpdate=!0;var v=new g.a(u,d);r.add(v)}o.render(r,n)}}()};return Object(l.useEffect)((function(){Object(m.a)(v.a.mark((function e(){var t;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.mediaDevices.getUserMedia({video:{maxHeight:480}});case 2:t=e.sent,b.current.srcObject=t,P(t);case 5:case"end":return e.stop()}}),e)})))()}),[]),s.a.createElement("div",{className:"App"},s.a.createElement("div",null,s.a.createElement("div",null,s.a.createElement("b",null,"original")),s.a.createElement("video",{ref:b,autoPlay:!0,playsInline:!0})),s.a.createElement("div",null,s.a.createElement("div",null,s.a.createElement("b",null,"shader")),s.a.createElement("canvas",{ref:E}),s.a.createElement("div",null,"sigma"),s.a.createElement("input",{type:"range",min:"0",max:"10",step:"0.1",value:a,onChange:function(e){c(e.target.value),i.sigma.value=e.target.value}}),a,s.a.createElement("div",null,"radius"),s.a.createElement("input",{type:"range",min:"0",max:"10",step:"0.1",value:h,onChange:function(e){x(e.target.value),i.radius.value=e.target.value}}),h,s.a.createElement("div",null,"threshold"),s.a.createElement("input",{type:"range",min:"0",max:"1",step:"0.01",value:y,onChange:function(e){S(e.target.value),i.threshold.value=e.target.value}}),y),s.a.createElement("script",{id:"fs",type:"x-shader/x-fragment"},"\n#define INV_SQRT_OF_2PI 0.39894228040143267793994605993439 // 1.0/SQRT_OF_2PI\n#define INV_PI 0.31830988618379067153776752674503\nuniform vec2      resolution;\nuniform sampler2D iChannel0;\nuniform float  sigma;\nuniform float  radius;\nuniform float  threshold;\n\nvec4 smartDeNoise(sampler2D tex, vec2 uv, float sigma, float kSigma, float threshold)\n{\n    float radius = round(kSigma*sigma);\n    float radQ = radius * radius;\n\n    float invSigmaQx2 = .5 / (sigma * sigma);      // 1.0 / (sigma^2 * 2.0)\n    float invSigmaQx2PI = INV_PI * invSigmaQx2;    // 1.0 / (sqrt(PI) * sigma)\n\n    float invThresholdSqx2 = .5 / (threshold * threshold);     // 1.0 / (sigma^2 * 2.0)\n    float invThresholdSqrt2PI = INV_SQRT_OF_2PI / threshold;   // 1.0 / (sqrt(2*PI) * sigma)\n\n    vec4 centrPx = texture(tex,uv);\n\n    float zBuff = 0.0;\n    vec4 aBuff = vec4(0.0);\n    vec2 size = vec2(textureSize(tex, 0));\n\n    for(float x=-radius; x <= radius; x++) {\n        float pt = sqrt(radQ-x*x);  // pt = yRadius: have circular trend\n        for(float y=-pt; y <= pt; y++) {\n            vec2 d = vec2(x,y);\n\n            float blurFactor = exp( -dot(d , d) * invSigmaQx2 ) * invSigmaQx2PI;\n\n            vec4 walkPx =  texture(tex,uv+d/size);\n\n            vec4 dC = walkPx-centrPx;\n            float deltaFactor = exp( -dot(dC, dC) * invThresholdSqx2) * invThresholdSqrt2PI * blurFactor;\n\n            zBuff += deltaFactor;\n            aBuff += deltaFactor*walkPx;\n        }\n    }\n    return aBuff/zBuff;\n}\n\nvoid main( void )\n{\n    vec2 pos = gl_FragCoord.xy / resolution.xy;\n     //gl_FragColor = vec4(1.0,pos.x,pos.y,1.0);\n    //vec2 uv = vec2(gl_FragCoord.xy / wSize);\n    gl_FragColor = smartDeNoise(iChannel0, vec2(pos.x,pos.y), sigma, radius, threshold);\n    //gl_FragColor = texture2D( iChannel0, gl_FragCoord.xy );\n}\n                "))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));u.a.render(s.a.createElement(s.a.StrictMode,null,s.a.createElement(h,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},7:function(e,t,a){e.exports=a(15)}},[[7,1,2]]]);
//# sourceMappingURL=main.9733e1fc.chunk.js.map